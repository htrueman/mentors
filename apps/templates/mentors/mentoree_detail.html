{% extends 'base.html' %}
{% load static date_tags jsonify %}

{% block content %}
  <div class="content">
    <section class="admin-link-nav">
      <div class="container">
        <a class="admin-link" href="{% url 'mentors:mentor_office' %}">Особистий кабінет наставника ></a>
        <a class="admin-link active" href=""> {{ mentoree.first_name }} {{ mentoree.last_name }}</a></div>
    </section>
    <section class="admin">
      <div class="container">
        <div class="admin-wrapp">
          <div class="admin-left">
            {% with mentoree as m %}
              <div class="admin-card">
                <div class="admin-card-info"><img src="{{ m.profile_image.url }}" alt="">
                  <div>
                    <h2 class="admin-card-name">{{ m.first_name }}<br>{{ m.last_name }}</h2>
                    <p class="admin-card-birth">Дата народження</p>
                    <p class="admin-card-data">{{ m.date_of_birth|date:'d.m.Y' }} <span class="admin-card-age">({{ m.date_of_birth|get_age }}  років)</span></p>
                  </div><a class="admin-card-bage" href=""><i class="fas fa-pencil-alt"></i></a>
                </div>
                <div class="admin-card-line"></div>
                <div class="admin-card-dream">
                  <div><span class="admin-card-dream-name">Мрія</span>
                    <p class="admin-card-dream-item">{{ m.dream }}</p><span class="admin-card-dream-name">Боїться</span>
                    <p class="admin-card-dream-item">{{ m.fears }}</p><span class="admin-card-dream-name">Ненавидить</span>
                    <p class="admin-card-dream-item">{{ m.hates }}</p><span class="admin-card-dream-name">Інше</span>
                    <p class="admin-card-dream-item">{{ m.extra_data }}</p>
                  </div>
                  <div><span class="admin-card-dream-name">Хочу стати</span>
                    <p class="admin-card-dream-item">{{ m.want_to_become }}</p><span class="admin-card-dream-name">Любить</span>
                    <p class="admin-card-dream-item">{{ m.loves }}</p><span class="admin-card-dream-name">Сильні сторони</span>
                    <p class="admin-card-dream-item">{{ m.strengths }}</p>
                  </div>
                </div>
                <div class="admin-card-line"></div>
                <div class="admin-card-place"><span>Установа:</span>
                  <p>{{ m.organization.name }}</p>
                </div>
                <div class="admin-card-adress">
                  <div><span>Адреса:</span>
                    <p>{{ m.organization.address }}</p>
                  </div>
                  <div><span>Телефони установи:</span>
                    {% for number in m.organization.phone_numbers %}
                      <p>{{ number }}</p>
                    {% endfor %}
                  </div>
                </div>
              </div>
            {% endwith %}
          </div>
          <div class="admin-right" id="extra-data-fields">
            <div class="worksheet" v-if="viewMode">
              <a class="worksheet-bage" href="javascript: void(0)" @click="viewMode=false">
                <i class="fas fa-pencil-alt"></i>
              </a>
              <div class="worksheet-input" v-for="item in dataFields.slice(sliceStart, sliceEnd)">
                <span>[[ Object.keys(item)[0] ]]:</span>
                <p>[[ Object.values(item)[0] ]]</p>
              </div>
              <div class="worksheet-page">
                <template v-for="pageNumber in pageCount">
                  <a :class="{active: pageNumber === activePageNumber}"
                     href="javascript: void(0)"
                     @click="paginate(pageNumber)"
                  >
                    [[ pageNumber ]]
                  </a>
                </template>
              </div>
            </div>
            <div class="setting-worksheet" v-else>
              <div class="setting-worksheet-sett">
                <a class="setting-worksheet-bage"
                   href="javascript: void(0)"
                   title="Add"
                   @click="addNewExtraDataField()"
                ><i class="fas fa-plus"></i>
                </a>
                <a class="setting-worksheet-bage"
                   href="javascript: void(0)"
                   title="Submit"
                   @click="saveDataFields()"
                >
                  <i class="fas fa-check"></i>
                </a>
              </div>
              <div class="setting-worksheet-input"
                   v-for="(item, index) in dataFields.slice(sliceStart, sliceEnd)"
                   :key="Object.keys(item)[0]"
              >
                <div class="setting-worksheet-header">
                  <input class="setting-worksheet-title"
                         type="text"
                         :value="Object.keys(item)[0]"
                         placeholder="Введіть тему"
                         @input="changeDataFieldThemeData(index, $event.target.value)"
                  >
                  <a class="setting-worksheet-clear"
                     href="javascript: void(0)"
                     title="Clear"
                     @click="removeDataField(index + (activePageNumber - 1) * sliceStep)"
                  ><i class="fas fa-minus"></i>
                  </a>
                </div>
                <span class="error-form" v-if="emptyDataFieldKeyIndexes.includes(index)">Необхідно ввести тему</span>

                <input :class="{'setting-worksheet-item': Object.values(item)[0], 'setting-worksheet-item-new': !Object.values(item)[0]}"
                       type="text"
                       :value="Object.values(item)[0]"
                       placeholder="Введіть текст тут"
                       @input="changeDataFieldValueData(index, $event.target.value)"
                >
                <span class="error-form" v-if="emptyDataFieldValueIndexes.includes(index)">Необхідно ввести текст</span>

              </div>
              <div class="setting-worksheet-page">
                <template v-for="pageNumber in pageCount">
                  <a :class="{active: pageNumber === activePageNumber}"
                     href="javascript: void(0)"
                     @click="paginate(pageNumber)"
                  >
                    [[ pageNumber ]]
                  </a>
                </template>
              </div>
            </div>
          </div>
        </div>
        <div class="worksheet-history-page">
          <div class="worksheet-history">
            <h2>Коротка історія дитини</h2>
            <div class="worksheet-line"></div>
            <div class="worksheet-wrapp"><img src="{{ mentoree.story_images.first.image.url }}" alt="">
              <p>{{ mentoree.story }}</p>
            </div><a href="">Доповнити історію</a>
          </div>
        </div>
      </div>
    </section>
  </div>
{% endblock %}

{% block extra_js %}
  <script>
    const extraDataFields = '{{ mentoree.extra_data_fields|jsonify }}';
    const userId = '{{ user.pk }}';
  </script>
  <script src="{% static 'scripts/jquery-3.3.1.min.js' %}"></script>
  <script src="{% static 'scripts/owl.carousel.min.js' %}"></script>
  <script src="{% static 'scripts/ajax_setup.js' %}"></script>
  <script src="{% static 'scripts/extra_mentoree_data.js' %}"></script>
{% endblock %}